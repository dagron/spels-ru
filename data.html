<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01//EN"
   "http://www.w3.org/TR/html4/strict.dtd"> 
<html> 
  <head> 
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8"> 
    <link rel="stylesheet" type="text/css" href="css/style.css"> 
    <link href="css/prettify.css" type="text/css" rel="stylesheet"> 
    <script type="text/javascript" src="js/prettify.js"></script> 
    <script type="text/javascript" src="js/lang-clojure.js"></script> 
    <title>Casting SPELs with Clojure: Defining Data</title> 
  </head> 
  <body onLoad="prettyPrint()"> 
    <div class="main"> 
      <div class="top"> 
        <span class="pager"><a href="casting.html">&lt;&lt; начало</a></span> 
        <span class="pager"><a href="syntax.html">&lt; назад</a></span> 
        <span class="pager"><a href="casting.html">1</a></span> 
        <span class="pager"><a href="syntax.html">2</a></span> 
        <span class="pager current">3</span> 
        <span class="pager"><a href="looking.html">4</a></span> 
        <span class="pager"><a href="walking.html">5</a></span> 
        <span class="pager"><a href="spels.html">6</a></span> 
        <span class="pager"><a href="actions.html">7</a></span> 
        <span class="pager"><a href="addendum.html">8</a></span> 
        <span class="pager"><a href="no_macros.html">9</a></span> 
        <span class="pager"><a href="looking.html">вперед &gt;</a></span> 
        <span class="pager"><a href="no_macros.html">конец &gt;&gt;</a></span> 
        <span class="pagertext">Опеределяем данные...</span> 
      </div> 
      <div class="heading">Опеределяем данные для нашего Игрового Мира</div> 
      <div class="textblock"> 
        <p> Для того, чтобы узнать больше о формах, давайте создадим несколько форм, которые создадут данные для нашего
	  игрового мира. Для начала, в нашей игре будет несколько объектов, которые игрок сможет подбирать и
	  использовать - давайте определим эти объекты:
        </p> 
        <pre class="prettyprint lang-clojure">(def objects '(whiskey-bottle bucket frog chain))</pre> 
        <p> Отлично, теперь разберем эту строчку и посмотрим, что она означает: так как компилятор Lisp всегда начинает
	  читать в <b>Режиме Кода</b> и ожидает форму, то первый символ <code>def</code> должен быть командой. В этом
	  случае, команда устанавливает переменной значение: переменная это <code>objects</code> и значение, которые мы
	  устанавливаем ей это список из четырех объектов. Теперь, так как список это данные (т.е. мы не хотим, чтобы
	  компилятор пытался вызывать функцию, которая называется <code>whiskey-bottle</code>), то мы должны
	  "переключить" компилятор в <b>Режим Данных</b>, когда он будет читать этот список. Одинарная кавычка в начале
	  списке это команда, которые указывает компилятору переключиться:
        </p> 
      </div> 
      <img src="images/objects.jpg" alt="Список объектов"> 
      <div class="textblock"> 
        <p> Команда <code>def</code> используется, чтобы задать значение. (от английского слова "<b>def</b>ine",
          "задать"). (Если вы уже знаете Common Lisp, то можете знать, что эквивалентная команда была бы
          "<code>setf</code>". У Clojure, на самом деле, команды <code>setf</code> нет).
        </p> 
        <p> Теперь, после того как мы определили объекты в нашем мире, давайте создадим и карту (отображение?) реального
        мира. Вот картина, как наш мир может выглядеть:
        </p> 
      </div> 
      <img src="images/world.jpg" alt="Игровой мир"> 
      <div class="textblock"> 
        <p> В этой простой игре будет только три различных направления: дом с гостиной и чердаком, а также сад. Давайте
	  определим новую переменную, называемую <code>game-map</code>, которая будет описывать наш маленький мир:
        </p> 
        <pre class="prettyprint lang-clojure"> 
(def game-map (hash-map
   'living-room '((you are in the living room
                   of a wizards house - there is a wizard
                   snoring loudly on the couch -)
                  (west door garden)
                  (upstairs stairway attic))
   'garden '((you are in a beautiful garden -
              there is a well in front of you -)
             (east door living-room))
   'attic '((you are in the attic of the
             wizards house - there is a giant
             welding torch in the corner -)
            (downstairs stairway living-room))))
        </pre> 
        <p> Это отображение содержит все необходимое, что мы хотим знать о наших трех местоположениях: уникальное имя
          для каждого из местоположения (т.е. <i>house</i>, <i>garden</i>, and
          <i>attic</i>), небольшое описание того, что мы можем там увидеть (хранится в своем собственном списке внутри
          большого списка), плюс к этому <i>куда и как</i> можнo попасть в/из этого места. Обратите внимание, насколько
          много информации хранится в одной переменной и как она описывает все, что нам нужно и ничего лишнего - Лисперы
          любят создавать маленькие, лаконичные куски кода без шелухи, которые легко понять просто посмотрев на них.
        </p> 
        <p> Теперь, когда у нас есть карта и набор объектов, имеет смысл создать другую переменную которая расскажет,
          где эти объекты находятся на карте.
        </p> 
        <pre class="prettyprint lang-clojure"> 
(def object-locations (hash-map
                       'whiskey-bottle 'living-room
                       'bucket 'living-room
                       'chain 'garden
                       'frog 'garden))
         </pre> 
         <p> 
           Теперь у нас каждый объект связан с конкретным местом. Clojure предлагает структуру данных, которая называется <b>Map</b> или отображение.
           Отображение создается вызовом функции  <code>hash-map</code> со списком параметров в порядке <code>ключ1 значение1 ключ2 значение2...</code> 
           Наша переменная <code>game-map</code> тоже является отображением - три ключа в этом случае были <i>living-room</i>,
           <i>garden</i>, and <i>attic</i>.
         </p> 
       </div> 
       <div class="note"> 
        <p> 
          <img src="images/wizard-small.png" style="margin-right:15px; float:left" alt="Little Wizard"> Оригинальное
          руководство использовало ассоциированные списки. Clojure не поддерживает ассоциированные списки напрямую,
          вместо этого он поставляется с hash-map-ами, которые мы используем в качестве отображающей структуры данных.
        </p> 
       </div> 
       <div class="textblock"> 
         <p> 
           Теперь когда мы задали наш мир и объекты в мире, единственная вещь, которую осталось описать это месторасположение игрока в мире:
         </p> 
        <pre class="prettyprint lang-clojure">(def location 'living-room)</pre> 
        <p> 
          А теперь давайте создадим немного игровых команд! 
        </p> 
      </div> 
      <img src="images/drink.jpg" alt="Drinking Wizard"> 
      <hr> 
      <div class="bottom"> 
        <span class="pager"><a href="casting.html">&lt;&lt; начало</a></span> 
        <span class="pager"><a href="syntax.html">&lt; назад</a></span> 
        <span class="pager"><a href="casting.html">1</a></span> 
        <span class="pager"><a href="syntax.html">2</a></span> 
        <span class="pager current">3</span> 
        <span class="pager"><a href="looking.html">4</a></span> 
        <span class="pager"><a href="walking.html">5</a></span> 
        <span class="pager"><a href="spels.html">6</a></span> 
        <span class="pager"><a href="actions.html">7</a></span> 
        <span class="pager"><a href="addendum.html">8</a></span> 
        <span class="pager"><a href="no_macros.html">9</a></span> 
        <span class="pager"><a href="looking.html">вперед &gt;</a></span> 
        <span class="pager"><a href="no_macros.html">конец &gt;&gt;</a></span> 
        <span class="pagertext">Определяем данные...</span> 
      </div> 
  </div> 
  </body> 
</html> 
